<!-- Hero (minimal : only left/right bracket illustrations) -->
<section class="relative overflow-hidden mb-lg">
  <div class="max-w-7xl mx-auto px-md sm:px-lg lg:px-xl relative z-10">
    <div class="relative text-center py-10 md:py-14">
      <!-- Left bracket (desktop only) -->
      <img
        src="/assets/illustrations/bracket.png"
        alt=""
        aria-hidden="true"
        class="hidden lg:block absolute top-1/2 -left-14 w-14 -translate-y-1/2 opacity-60 transform-gpu"
        style="filter: drop-shadow(0 6px 14px rgba(0, 0, 0, 0.06))"
      />
      <!-- Right bracket (mirrored, desktop only) -->
      <img
        src="/assets/illustrations/bracket.png"
        alt=""
        aria-hidden="true"
        class="hidden lg:block absolute top-1/2 -right-14 w-14 -translate-y-1/2 opacity-60 transform-gpu scale-x-[-1]"
        style="filter: drop-shadow(0 6px 14px rgba(0, 0, 0, 0.06))"
      />

      <h1 class="text-3xl md:text-4xl font-bold text-text mb-2">Q&A</h1>
      <p class="text-text/70 max-w-2xl mx-auto">
        Les réponses officielles à vos questions. Recherche rapide, filtres par catégorie — contenu
        en place pour la V1.
      </p>
    </div>
  </div>
</section>

<!-- Main content -->
<section class="max-w-7xl mx-auto px-md pb-lg">
  <!-- Controls -->
  <div class="flex flex-col md:flex-row items-start md:items-center gap-4 mb-md">
    <div class="flex-1 w-full">
      <label class="sr-only" for="qa-search">Rechercher</label>
      <input
        id="qa-search"
        type="search"
        [(ngModel)]="search"
        placeholder="Rechercher — ex : inscription, speakers, workshop..."
        class="w-full rounded-md border px-sm py-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/30"
        aria-label="Recherche Q&A"
      />
    </div>

    <div class="flex gap-2 flex-wrap">
      <button
        *ngFor="let c of categories"
        (click)="selectCategory(c)"
        [attr.aria-pressed]="
          (activeCategory === '' && c === 'Tout') || activeCategory === c ? 'true' : 'false'
        "
        [ngClass]="{
          'bg-primary text-white shadow-sm':
            (activeCategory === '' && c === 'Tout') || activeCategory === c,
          'bg-white text-text/80 border': !(
            (activeCategory === '' && c === 'Tout') ||
            activeCategory === c
          )
        }"
        class="px-md py-sm rounded-md text-sm font-medium transition"
      >
        {{ c }}
      </button>
    </div>
  </div>

  <!-- Results -->
  <div *ngIf="filtered.length; else empty" class="space-y-3">
    <article
      *ngFor="let item of filtered"
      class="bg-white rounded-lg p-md shadow-card"
      role="region"
      [attr.aria-labelledby]="'q-' + item.id"
    >
      <header class="flex items-start justify-between gap-3">
        <div class="flex-1">
          <h3 id="{{ 'q-' + item.id }}" class="font-semibold text-text text-base mb-1">
            <button
              class="w-full text-left"
              (click)="toggle(item.id)"
              [attr.aria-expanded]="isOpen(item.id)"
              [attr.aria-controls]="'qa-' + item.id"
            >
              {{ item.question }}
            </button>
          </h3>
          <div class="text-xs text-text/60">
            <span *ngIf="item.category" class="mr-2">{{ item.category }}</span>
            <span *ngIf="item.updatedAt">• mis à jour {{ item.updatedAt }}</span>
          </div>
        </div>

        <div class="flex-shrink-0 pl-3">
          <span class="chev" [class.open]="isOpen(item.id)" aria-hidden="true">▾</span>
        </div>
      </header>

      <div id="{{ 'qa-' + item.id }}" class="mt-3 text-text/80" [hidden]="!isOpen(item.id)">
        <p [innerHTML]="item.answer"></p>

        <div *ngIf="item.tags?.length" class="mt-3 flex gap-2 flex-wrap">
          <span
            *ngFor="let t of item.tags"
            class="px-2 py-0.5 text-xs rounded bg-text/5 text-text/70"
            >{{ t }}</span
          >
        </div>
      </div>
    </article>
  </div>

  <ng-template #empty>
    <div class="text-center py-lg text-text/70">
      Aucune question correspondante. Essaie un autre mot-clé ou réinitialise le filtre.
    </div>
  </ng-template>
</section>

<!-- Local styles: subtle, professional -->
<style>
  .chev {
    transition: transform 0.18s ease;
    display: inline-block;
    font-size: 1rem;
    color: rgba(30, 30, 30, 0.7);
  }
  .chev.open {
    transform: rotate(180deg);
  }
  .shadow-card {
    box-shadow: 0 6px 18px rgba(22, 22, 22, 0.04);
  }
  @media (prefers-reduced-motion: reduce) {
    .chev {
      transition: none;
    }
  }
</style>
